<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PharmaShe - Women-Centric Cancer Pharmaceutical Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    backdropBlur: {
                        'xs': '2px',
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            background-attachment: fixed;
            min-height: 100vh;
        }
        .glass {
            background: rgba(255, 255, 255, 0.1);
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.15);
            -webkit-backdrop-filter: blur(15px);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            transition: all 0.3s ease;
        }
        .glass-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px 0 rgba(31, 38, 135, 0.5);
        }
        .nav-glass {
            background: rgba(0, 0, 0, 0.2);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .scrollbar-thin::-webkit-scrollbar {
            width: 6px;
        }
        .scrollbar-thin::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
        }
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
        }
        .scrollbar-thin::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            color: white;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-active {
            background-color: #4CAF50;
        }

        .status-processing {
            background-color: #FF9800;
        }

        .message {
            margin-bottom: 15px;
            padding: 15px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .message.user {
            background: rgba(139, 92, 246, 0.2);
            margin-left: 20px;
        }

        .message.system {
            background: rgba(236, 72, 153, 0.2);
            margin-right: 20px;
        }

        .message h4 {
            color: #a855f7;
            margin-bottom: 5px;
        }

        .loading {
            display: none;
            text-align: center;
            color: #a855f7;
        }

        .loading.show {
            display: block;
        }

        /* From Uiverse.io by Yaya12085 */ 
        .form-container {
          width: 320px;
          border-radius: 0.75rem;
          background-color: rgba(17, 24, 39, 1);
          padding: 2rem;
          color: rgba(243, 244, 246, 1);
        }

        .title {
          text-align: center;
          font-size: 1.5rem;
          line-height: 2rem;
          font-weight: 700;
        }

        .form {
          margin-top: 1.5rem;
        }

        .input-group {
          margin-top: 0.25rem;
          font-size: 0.875rem;
          line-height: 1.25rem;
        }

        .input-group label {
          display: block;
          color: rgba(156, 163, 175, 1);
          margin-bottom: 4px;
        }

        .input-group input {
          width: 100%;
          border-radius: 0.375rem;
          border: 1px solid rgba(55, 65, 81, 1);
          outline: 0;
          background-color: rgba(17, 24, 39, 1);
          padding: 0.75rem 1rem;
          color: rgba(243, 244, 246, 1);
        }

        .input-group input:focus {
          border-color: rgba(167, 139, 250);
        }

        .forgot {
          display: flex;
          justify-content: flex-end;
          font-size: 0.75rem;
          line-height: 1rem;
          color: rgba(156, 163, 175,1);
          margin: 8px 0 14px 0;
        }

        .forgot a,.signup a {
          color: rgba(243, 244, 246, 1);
          text-decoration: none;
          font-size: 14px;
        }

        .forgot a:hover, .signup a:hover {
          text-decoration: underline rgba(167, 139, 250, 1);
        }

        .sign {
          display: block;
          width: 100%;
          background-color: rgba(167, 139, 250, 1);
          padding: 0.75rem;
          text-align: center;
          color: rgba(17, 24, 39, 1);
          border: none;
          border-radius: 0.375rem;
          font-weight: 600;
          cursor: pointer;
        }

        .social-message {
          display: flex;
          align-items: center;
          padding-top: 1rem;
        }

        .line {
          height: 1px;
          flex: 1 1 0%;
          background-color: rgba(55, 65, 81, 1);
        }

        .social-message .login-message {
          padding-left: 0.75rem;
          padding-right: 0.75rem;
          font-size: 0.875rem;
          line-height: 1.25rem;
          color: rgba(156, 163, 175, 1);
        }

        .social-icons {
          display: flex;
          justify-content: center;
        }

        .social-icons .icon {
          border-radius: 0.125rem;
          padding: 0.75rem;
          border: none;
          background-color: transparent;
          margin-left: 8px;
          cursor: pointer;
        }

        .social-icons .icon svg {
          height: 1.25rem;
          width: 1.25rem;
          fill: #fff;
        }

        .signup {
          text-align: center;
          font-size: 0.75rem;
          line-height: 1rem;
          color: rgba(156, 163, 175, 1);
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Navigation -->
    <nav class="nav-glass fixed top-0 left-0 right-0 z-50 p-4">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="text-2xl font-bold text-white">PharmaShe</div>
            <div class="hidden md:flex space-x-6">
                <a href="#dashboard" class="text-white hover:text-purple-300 transition-colors">Dashboard</a>
                <a href="#research" class="text-white hover:text-purple-300 transition-colors">Research</a>
                <a href="#reports" class="text-white hover:text-purple-300 transition-colors">Reports</a>
                <a href="#settings" class="text-white hover:text-purple-300 transition-colors">Settings</a>
                <button onclick="toggleLoginModal()" class="bg-white/10 hover:bg-white/20 text-white px-4 py-2 rounded-lg transition-colors">Login</button>
            </div>
            <div class="md:hidden">
                <button id="menu-toggle" class="text-white focus:outline-none" aria-label="Toggle menu">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </div>
        <div id="mobile-menu" class="md:hidden hidden mt-4 pb-4">
            <a href="#dashboard" class="block text-white hover:text-purple-300 py-2">Dashboard</a>
            <a href="#research" class="block text-white hover:text-purple-300 py-2">Research</a>
            <a href="#reports" class="block text-white hover:text-purple-300 py-2">Reports</a>
            <a href="#settings" class="block text-white hover:text-purple-300 py-2">Settings</a>
            <button onclick="toggleLoginModal()" class="block w-full text-left text-white hover:text-purple-300 py-2">Login</button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-20 px-4 md:px-8">
        <div class="max-w-7xl mx-auto">
            <!-- Header -->
            <div class="text-center mb-12 animate-fade-in">
                <h1 class="text-4xl md:text-6xl font-bold mb-4 bg-gradient-to-r from-white to-purple-200 bg-clip-text text-transparent">
                    PharmaShe
                </h1>
                <p class="text-xl md:text-2xl text-white/80">
                    Women-Centric Cancer Pharmaceutical Platform
                </p>
            </div>

            <!-- API Status -->
            <div class="glass-card rounded-2xl p-6 mb-8 animate-fade-in">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
                    <h3 class="text-2xl font-semibold text-white mb-4 md:mb-0">API Status</h3>
                    <div class="flex items-center space-x-4">
                        <span class="status-indicator status-active"></span>
                        <span id="api-status-text" class="text-white">Connected</span>
                        <button class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors" onclick="testAPI()">Test API</button>
                    </div>
                </div>
            </div>

            <!-- Dashboard -->
            <div id="dashboard" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
                <!-- AI Agents Status -->
                <div class="glass-card rounded-2xl p-6 animate-fade-in">
                    <h3 class="text-xl font-semibold text-white mb-4">AI Agents Status</h3>
                    <div id="agents-status" class="space-y-2">
                        <p class="flex items-center text-white/90"><span class="status-indicator status-active"></span>Master Agent - Active</p>
                        <p class="flex items-center text-white/90"><span class="status-indicator status-active"></span>IQVIA Insights - Active</p>
                        <p class="flex items-center text-white/90"><span class="status-indicator status-active"></span>Patent Landscape - Active</p>
                        <p class="flex items-center text-white/90"><span class="status-indicator status-active"></span>Clinical Trials - Active</p>
                        <p class="flex items-center text-white/90"><span class="status-indicator status-active"></span>Report Generator - Active</p>
                    </div>
                </div>

                <!-- External Integrations -->
                <div class="glass-card rounded-2xl p-6 animate-fade-in">
                    <h3 class="text-xl font-semibold text-white mb-4">External Integrations</h3>
                    <div id="integrations-status" class="space-y-2 mb-4">
                        <p class="flex items-center text-white/90"><span class="status-indicator status-active"></span>ClinicalTrials.gov - Connected</p>
                        <p class="flex items-center text-white/90"><span class="status-indicator status-active"></span>USPTO - Connected</p>
                        <p class="flex items-center text-white/90"><span class="status-indicator status-active"></span>PubMed - Connected</p>
                        <p class="flex items-center text-white/90"><span class="status-indicator status-active"></span>FDA Drug API - Connected</p>
                    </div>
                    <button class="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-4 py-2 rounded-lg transition-all duration-300" onclick="testIntegrations()">Test Integrations</button>
                </div>

                <!-- Quick Actions -->
                <div class="glass-card rounded-2xl p-6 animate-fade-in">
                    <h3 class="text-xl font-semibold text-white mb-4">Quick Actions</h3>
                    <div class="space-y-3">
                        <button class="w-full bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white py-2 rounded-lg transition-all duration-300" onclick="generateReport()">Generate Report</button>
                        <button class="w-full bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 text-white py-2 rounded-lg transition-all duration-300" onclick="runSampleQuery()">Sample Query</button>
                        <button class="w-full bg-gray-600 hover:bg-gray-700 text-white py-2 rounded-lg transition-colors" onclick="viewAPI()">View API Docs</button>
                    </div>
                </div>
            </div>

            <!-- Research Query Interface -->
            <div id="research" class="glass-card rounded-2xl p-6 animate-fade-in">
                <h3 class="text-2xl font-semibold text-white mb-6">Research Query Interface</h3>
                <div class="flex flex-col md:flex-row gap-4 mb-6">
                    <input type="text" id="query-input"
                           class="flex-1 bg-white/10 border border-white/20 rounded-lg px-4 py-3 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent backdrop-blur-sm"
                           placeholder="Ask about women's cancer market analysis, patent landscape, clinical trials..."
                           value="Which women's cancers show rising incidence but low drug development activity globally?">
                    <button class="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-6 py-3 rounded-lg transition-all duration-300 font-medium" onclick="sendQuery()">Send Query</button>
                </div>
                <div class="loading mb-4" id="loading">Processing your query...</div>
                <div class="glass rounded-lg p-4 max-h-96 overflow-y-auto scrollbar-thin" id="chat-messages">
                    <div class="message system animate-fade-in">
                        <h4>PharmaShe AI</h4>
                        <p class="text-white/90">Welcome to PharmaShe! I'm your AI research assistant specialized in women's oncology pharmaceutical research. I can help you analyze market trends, patent landscapes, clinical trials, and more. Try asking me about breast cancer market analysis or patent expiration opportunities.</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Login Modal -->
    <div id="login-modal" class="fixed inset-0 z-[60] hidden flex items-center justify-center bg-black/50 backdrop-blur-sm transition-opacity duration-300 opacity-0">
        <div class="form-container relative transform scale-95 transition-transform duration-300">
            <button onclick="toggleLoginModal()" class="absolute top-4 right-4 text-gray-400 hover:text-white">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
            <p class="title">Login</p>
            <form class="form" onsubmit="handleLogin(event)">
                <div class="input-group">
                    <label for="username">Username</label>
                    <input type="text" name="username" id="username" placeholder="">
                </div>
                <div class="input-group">
                    <label for="password">Password</label>
                    <input type="password" name="password" id="password" placeholder="">
                    <div class="forgot">
                        <a rel="noopener noreferrer" href="#">Forgot Password ?</a>
                    </div>
                </div>
                <div id="login-error" class="text-red-400 text-xs text-center mb-3 hidden"></div>
                <button class="sign">Sign in</button>
            </form>
            <div class="social-message">
                <div class="line"></div>
                <p class="login-message">Login with social accounts</p>
                <div class="line"></div>
            </div>
            <div class="social-icons">
                <button aria-label="Log in with Google" class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" class="w-5 h-5 fill-current">
                        <path d="M16.318 13.714v5.484h9.078c-0.37 2.354-2.745 6.901-9.078 6.901-5.458 0-9.917-4.521-9.917-10.099s4.458-10.099 9.917-10.099c3.109 0 5.193 1.318 6.38 2.464l4.339-4.182c-2.786-2.599-6.396-4.182-10.719-4.182-8.844 0-16 7.151-16 16s7.156 16 16 16c9.234 0 15.365-6.49 15.365-15.635 0-1.052-0.115-1.854-0.255-2.651z"></path>
                    </svg>
                </button>
            </div>
            <p class="signup">Don't have an account?
                <a rel="noopener noreferrer" href="#" class="">Sign up</a>
            </p>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8000';
        let useMock = false;

        // Mobile menu toggle
        document.getElementById('menu-toggle').addEventListener('click', function() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        });
        
        async function testAPI() {
            try {
                const response = await fetch(`${API_BASE}/`);
                const data = await response.json();
                document.getElementById('api-status-text').textContent = 'Connected';
                addMessage('system', 'API Test', `API is running: ${data.message}`);
                useMock = false;
            } catch (error) {
                document.getElementById('api-status-text').textContent = 'Offline (Mock Mode)';
                addMessage('system', 'System', 'Backend unreachable. Switched to Mock Mode for demonstration.');
                useMock = true;
            }
        }

        async function testIntegrations() {
            if (useMock) {
                await new Promise(r => setTimeout(r, 1000));
                addMessage('system', 'Integration Test', `(Mock) All integrations tested successfully. Found 1,245 clinical trials, 850 patents, 15,200 articles, and 142 FDA records.`);
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/api/external/test-integrations`);
                const data = await response.json();
                addMessage('system', 'Integration Test', `All integrations tested successfully. Found ${data.results.clinical_trials.count} clinical trials, ${data.results.uspto.count} patents, ${data.results.pubmed.count} articles, and ${data.results.fda.count} FDA records.`);
            } catch (error) {
                addMessage('system', 'Integration Test', 'Failed to test integrations');
            }
        }

        async function generateReport() {
            if (useMock) {
                await new Promise(r => setTimeout(r, 1000));
                addMessage('system', 'Report Generation', `(Mock) Report generation initiated. Report ID: RPT-${Math.floor(Math.random()*9000)+1000}. Estimated completion: 2 minutes.`);
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/api/reports/generate`);
                const data = await response.json();
                addMessage('system', 'Report Generation', `Report generation initiated. Report ID: ${data.report_id}. Estimated completion: ${data.estimated_completion}.`);
            } catch (error) {
                addMessage('system', 'Report Generation', 'Failed to generate report');
            }
        }

        async function runSampleQuery() {
            const query = "breast cancer market analysis";
            document.getElementById('query-input').value = query;
            await sendQuery();
        }

        async function sendQuery() {
            const query = document.getElementById('query-input').value.trim();
            if (!query) return;

            addMessage('user', 'You', query);
            document.getElementById('loading').classList.add('show');

            if (useMock) {
                await new Promise(r => setTimeout(r, 2000));
                const mockData = {
                    query: query,
                    status: "Completed",
                    agents_involved: ["Master Agent", "Market Analyst", "Patent Scout"],
                    estimated_time: "1.4s",
                    results: {
                        market_analysis: {
                            market_size: "$12.5 Billion",
                            growth_rate: "6.8% CAGR",
                            key_players: ["Roche", "Novartis", "Pfizer"]
                        },
                        patent_landscape: {
                            total_patents: 1240,
                            active_patents: 850,
                            expiring_soon: 42
                        },
                        clinical_trials: {
                            total_trials: 315,
                            active_trials: 112,
                            recruiting: 45
                        }
                    }
                };
                displayResults(mockData);
                document.getElementById('loading').classList.remove('show');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/api/research/query?query=${encodeURIComponent(query)}`);
                const data = await response.json();
                displayResults(data);
            } catch (error) {
                addMessage('system', 'Error', 'Failed to process query. Please try again.');
            } finally {
                document.getElementById('loading').classList.remove('show');
            }
        }

        function displayResults(data) {
            let responseText = `Query: "${data.query}"\n\n`;
            responseText += `Status: ${data.status}\n`;
            responseText += `Agents Involved: ${data.agents_involved.join(', ')}\n`;
            responseText += `Estimated Time: ${data.estimated_time}\n\n`;
            
            if (data.results) {
                responseText += `Market Analysis:\n`;
                responseText += `- Market Size: ${data.results.market_analysis.market_size}\n`;
                responseText += `- Growth Rate: ${data.results.market_analysis.growth_rate}\n`;
                responseText += `- Key Players: ${data.results.market_analysis.key_players.join(', ')}\n\n`;
                
                responseText += `Patent Landscape:\n`;
                responseText += `- Total Patents: ${data.results.patent_landscape.total_patents.toLocaleString()}\n`;
                responseText += `- Active Patents: ${data.results.patent_landscape.active_patents.toLocaleString()}\n`;
                responseText += `- Expiring Soon: ${data.results.patent_landscape.expiring_soon}\n\n`;
                
                responseText += `Clinical Trials:\n`;
                responseText += `- Total Trials: ${data.results.clinical_trials.total_trials}\n`;
                responseText += `- Active Trials: ${data.results.clinical_trials.active_trials}\n`;
                responseText += `- Currently Recruiting: ${data.results.clinical_trials.recruiting}`;
            }
            
            addMessage('system', 'PharmaShe AI', responseText);
        }

        function addMessage(type, sender, content) {
            const messagesDiv = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            messageDiv.innerHTML = `<h4>${sender}</h4><p>${content.replace(/\n/g, '<br>')}</p>`;
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        function viewAPI() {
            window.open(`${API_BASE}/docs`, '_blank');
        }

        function toggleLoginModal() {
            const modal = document.getElementById('login-modal');
            const container = modal.querySelector('.form-container');
            
            if (modal.classList.contains('hidden')) {
                modal.classList.remove('hidden');
                // Trigger reflow
                void modal.offsetWidth;
                modal.classList.remove('opacity-0');
                container.classList.remove('scale-95');
                container.classList.add('scale-100');
            } else {
                modal.classList.add('opacity-0');
                container.classList.remove('scale-100');
                container.classList.add('scale-95');
                setTimeout(() => {
                    modal.classList.add('hidden');
                }, 300);
            }
        }

        async function handleLogin(event) {
            event.preventDefault();
            const usernameInput = document.getElementById('username');
            const passwordInput = document.getElementById('password');
            const errorDiv = document.getElementById('login-error');
            const submitBtn = event.target.querySelector('button');
            
            const username = usernameInput.value;
            const password = passwordInput.value;
            const originalBtnText = submitBtn.innerText;

            // Reset error
            errorDiv.classList.add('hidden');
            errorDiv.textContent = '';

            if (!username || !password) {
                errorDiv.textContent = 'Please enter both username and password';
                errorDiv.classList.remove('hidden');
                return;
            }

            submitBtn.innerText = 'Signing in...';
            submitBtn.disabled = true;

            try {
                if (useMock) {
                    // Mock login simulation
                    await new Promise(r => setTimeout(r, 1000));
                    if (username.toLowerCase() === 'admin' && password === 'admin') {
                        handleLoginSuccess({ access_token: 'mock-token-123', username: username });
                    } else {
                        throw new Error('Invalid credentials (try admin/admin)');
                    }
                } else {
                    // Connect to actual backend (Standard FastAPI OAuth2 endpoint is often /token)
                    const formData = new URLSearchParams();
                    formData.append('username', username);
                    formData.append('password', password);

                    const response = await fetch(`${API_BASE}/token`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                        },
                        body: formData
                    });

                    if (!response.ok) {
                        const errData = await response.json().catch(() => ({}));
                        throw new Error(errData.detail || 'Login failed');
                    }

                    const data = await response.json();
                    handleLoginSuccess({ ...data, username });
                }
            } catch (error) {
                errorDiv.textContent = error.message;
                errorDiv.classList.remove('hidden');
                // Shake animation effect
                const container = document.querySelector('.form-container');
                container.classList.add('animate-pulse');
                setTimeout(() => container.classList.remove('animate-pulse'), 500);
            } finally {
                submitBtn.innerText = originalBtnText;
                submitBtn.disabled = false;
            }
        }

        function handleLoginSuccess(data) {
            localStorage.setItem('token', data.access_token);
            localStorage.setItem('user', data.username);
            
            updateAuthUI(true, data.username);
            toggleLoginModal();
            
            // Clear form
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            
            addMessage('system', 'System', `Welcome back, ${data.username}!`);
        }

        function handleLogout() {
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            updateAuthUI(false);
            addMessage('system', 'System', 'You have been logged out.');
        }

        function updateAuthUI(isLoggedIn, username) {
            // Find all login buttons (desktop and mobile)
            const navButtons = document.querySelectorAll('nav button');
            
            navButtons.forEach(btn => {
                if (btn.innerText.includes('Login') || btn.innerText.includes('Logout')) {
                    if (isLoggedIn) {
                        btn.innerText = 'Logout';
                        btn.onclick = handleLogout;
                    } else {
                        btn.innerText = 'Login';
                        btn.onclick = toggleLoginModal;
                    }
                }
            });
        }

        // Test API connection on page load
        window.onload = function() {
            testAPI();
            
            // Check for existing session
            const token = localStorage.getItem('token');
            const user = localStorage.getItem('user');
            if (token && user) {
                updateAuthUI(true, user);
            }
        };

        // Allow Enter key to send query
        document.getElementById('query-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendQuery();
            }
        });
    </script>
</body>
</html>
